# ðŸšŒ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø±Ø­Ù„Ø§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±
## ML Regression Model for Transport Delay Prediction

---

## ðŸ“‹ Ø§Ù„ÙˆØµÙ

Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù†Ù…ÙˆØ°Ø¬ **Machine Learning** Ù…ØªÙ‚Ø¯Ù… Ù„Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø±Ø­Ù„Ø§Øª Ø§Ù„ØªØ£Ø®ÙŠØ± ÙÙŠ ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø¹Ø§Ù…. Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ØªÙ‚Ù†ÙŠØ§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ù…Ù† Ø§Ù„Ø§Ù†Ø­Ø¯Ø§Ø± (Regression) Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©.

### Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:
- âœ… **4 Ù†Ù…Ø§Ø°Ø¬ Ù…Ø®ØªÙ„ÙØ©**: Random Forest, Gradient Boosting, Ridge, Linear Regression
- âœ… **Ù…Ø¹Ø§Ù„Ø¬Ø© Ø°ÙƒÙŠØ© Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª**: Ù…Ù„Ø¡ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ÙØ§Ø±ØºØ©ØŒ ØªØ±Ù…ÙŠØ² Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ¦ÙˆÙŠØ©
- âœ… **Ù…ÙŠØ²Ø§Øª Ø²Ù…Ù†ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©**: Ø§Ù„Ø³Ø§Ø¹Ø©ØŒ Ø§Ù„ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ØŒ Ø§Ù„Ø´Ù‡Ø±ØŒ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
- âœ… **ØªØµÙˆØ± Ø´Ø§Ù…Ù„**: Ø±Ø³ÙˆÙ… Ø¨ÙŠØ§Ù†ÙŠØ© Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© ÙˆØ£Ù‡Ù…ÙŠØ© Ø§Ù„Ù…ÙŠØ²Ø§Øª
- âœ… **Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„**: RÂ², RMSE, MAE, Cross-validation

---

## ðŸ“Š Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

**Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù**: `dataset_with_features.csv`

### Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:
| Ø§Ù„Ø¹Ù…ÙˆØ¯ | Ø§Ù„ÙˆØµÙ |
|--------|-------|
| `delay_minutes_corrected` | Ø§Ù„ØªØ£Ø®ÙŠØ± Ø§Ù„ÙØ¹Ù„ÙŠ (Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚) - **Ø§Ù„Ù…ØªØºÙŠØ± Ø§Ù„ØªØ§Ø¨Ø¹** |
| `hour` | Ø§Ù„Ø³Ø§Ø¹Ø© Ù…Ù† Ø§Ù„ÙŠÙˆÙ… (0-23) |
| `day_period` | ÙØªØ±Ø© Ø§Ù„ÙŠÙˆÙ… (ØµØ¨Ø§Ø­ØŒ Ø¹ØµØ±ØŒ Ù…Ø³Ø§Ø¡ØŒ Ù„ÙŠÙ„) |
| `passenger_count_final` | Ø¹Ø¯Ø¯ Ø§Ù„Ø±ÙƒØ§Ø¨ |
| `weather_en` | Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù‚Ø³ |
| `prev_delay` | Ø§Ù„ØªØ£Ø®ÙŠØ± Ø§Ù„Ø³Ø§Ø¨Ù‚ |
| `route_frequency` | ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø± |
| `speed_proxy` | Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ |

---

## ðŸš€ ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### 1. ØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ÙƒØ§Ù…Ù„

```bash
python app.py
```

Ù‡Ø°Ø§ Ø³ÙŠÙ‚ÙˆÙ… Ø¨Ù€:
- ØªØ­Ù…ÙŠÙ„ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- Ø¨Ù†Ø§Ø¡ ÙˆØªØ¯Ø±ÙŠØ¨ 4 Ù†Ù…Ø§Ø°Ø¬ Ù…Ø®ØªÙ„ÙØ©
- Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
- Ø­ÙØ¸ Ø£ÙØ¶Ù„ Ù†Ù…ÙˆØ°Ø¬

**Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ÙÙ†ØªØ¬Ø©:**
- `best_delay_model.pkl` - Ø£ÙØ¶Ù„ Ù†Ù…ÙˆØ°Ø¬ Ù…Ø¯Ø±Ø¨
- `model_comparison.png` - Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
- `feature_importance.png` - Ø£Ù‡Ù…ÙŠØ© Ø§Ù„Ù…ÙŠØ²Ø§Øª

### 2. Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø±Ø­Ù„Ø© ØªØ£Ø®ÙŠØ±

```bash
python predict_delay.py
```

---

## ðŸ“ˆ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©

### Ù†Ù…Ø§Ø°Ø¬ Ù…Ø³ØªØ®Ø¯Ù…Ø©:

| Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ | Ù…Ù…ÙŠØ²Ø§Øª |
|---------|--------|
| **Random Forest** | Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¯Ù‚Ø©ØŒ ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø© |
| **Gradient Boosting** | Ø£ÙØ¶Ù„ Ø£Ø¯Ø§Ø¡ Ø¹Ù…ÙˆÙ…Ø§Ù‹ØŒ Ø£Ø¨Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ |
| **Ridge Regression** | Ø³Ø±ÙŠØ¹ØŒ Ø¬ÙŠØ¯ Ù„Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø®Ø·ÙŠØ© |
| **Linear Regression** | Ø¨Ø³ÙŠØ· ÙˆØ³Ø±ÙŠØ¹ |

### Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:
- **RÂ² (Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ¯)**: ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ¨Ø§ÙŠÙ† Ø§Ù„Ù…Ø´Ø±ÙˆØ­ (0-1)
- **RMSE (Ø¬Ø°Ø± Ù…ØªÙˆØ³Ø· Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø®Ø·Ø£)**: Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ù…ØªÙˆØ³Ø· Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚
- **MAE (Ù…ØªÙˆØ³Ø· Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ù…Ø·Ù„Ù‚)**: Ø§Ù„Ø§Ù†Ø­Ø±Ø§Ù Ø§Ù„Ù…ØªÙˆØ³Ø·

**Ø§Ù„Ù‡Ø¯Ù**: RÂ² > 0.7 Ùˆ RMSE < 10 Ø¯Ù‚Ø§Ø¦Ù‚

---

## ðŸ”§ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ«Ø¨ÙŠØª

```bash
pip install pandas numpy matplotlib seaborn scikit-learn
```

---

## ðŸ“ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

```
AI/
â”œâ”€â”€ app.py                          # Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø§Ù„ØªØ¯Ø±ÙŠØ¨)
â”œâ”€â”€ predict_delay.py                # Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„ØªÙ†Ø¨Ø¤
â”œâ”€â”€ dataset_with_features.csv       # Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
â”œâ”€â”€ best_delay_model.pkl            # Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø¯Ø±Ø¨
â”œâ”€â”€ model_comparison.png            # Ø±Ø³Ù… Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
â”œâ”€â”€ feature_importance.png          # Ø±Ø³Ù… Ø§Ù„Ù…ÙŠØ²Ø§Øª
â””â”€â”€ README.md                       # Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù
```

---

## ðŸ’¡ Ù†ØµØ§Ø¦Ø­ Ø§Ù„ØªØ­Ø³ÙŠÙ†

### Ù„ØªØ­Ø³ÙŠÙ† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:

1. **Ø¬Ù…Ø¹ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**: Ø²ÙŠØ§Ø¯Ø© Ø­Ø¬Ù… Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ­Ø³Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨
2. **feature engineering**: Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø«Ù„:
   - Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ù…Ø­Ø·Ø§Øª
   - Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø·Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø±ÙŠÙ‚
   - Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­ÙŠØ©
   
3. **Ø¶Ø¨Ø· Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª**: Ø§Ø³ØªØ®Ø¯Ø§Ù… `GridSearchCV` Ù„Ø¥ÙŠØ¬Ø§Ø¯ Ø£ÙØ¶Ù„ Ù…Ø¹Ø§Ù…Ù„Ø§Øª
4. **Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø´ÙˆØ§Ø¦Ø¨**: Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø§Ø°Ø© (Outliers)

---

## ðŸ“Š Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…

```python
from predict_delay import load_model, predict_delay

# ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
model = load_model()

# ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ù„Ù„ØªÙ†Ø¨Ø¤
features = {
    'hour': 18,                      # Ø§Ù„Ø³Ø§Ø¹Ø© 6 Ù…Ø³Ø§Ø¡Ù‹
    'day_of_week': 2,               # Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡
    'month': 1,                      # ÙŠÙ†Ø§ÙŠØ±
    'is_weekend': 0,                 # ÙŠÙˆÙ… Ø¹Ù…Ù„
    'day_period_encoded': 2,         # ÙØªØ±Ø© Ù…Ø³Ø§Ø¦ÙŠØ©
    'time_category_en_encoded': 2,   # Ø³Ø§Ø¹Ø© Ù…Ø³Ø§Ø¦ÙŠØ©
    'passenger_count_final': 50,     # 50 Ø±Ø§ÙƒØ¨
    'passenger_load_index': 1.5,     # Ù…Ø¤Ø´Ø± Ø§Ù„Ø­Ù…Ù„
    'prev_delay': 15,                # ØªØ£Ø®ÙŠØ± Ø³Ø§Ø¨Ù‚ 15 Ø¯Ù‚ÙŠÙ‚Ø©
    'rush_period': 1,                # ÙØªØ±Ø© Ø§Ù„Ø°Ø±ÙˆØ©
    'route_frequency': 69,           # ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ø³Ø§Ø±
    'speed_proxy': 0.5,              # Ù…Ø¤Ø´Ø± Ø§Ù„Ø³Ø±Ø¹Ø©
    'weather_severity': 0.0,         # Ø·Ù‚Ø³ ØµØ§ÙÙŠ
    'distance_change': 0.5,          # ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø³Ø§ÙØ©
    'latitude_clean': 25.5,          # Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ø±ÙŠØ¶
    'longitude_clean': 32.0,         # Ø®Ø· Ø§Ù„Ø·ÙˆÙ„
    'weather_en_encoded': 0,         # Ø·Ù‚Ø³ ØµØ§ÙÙŠ
    'passenger_level_encoded': 1,    # Ù…Ø³ØªÙˆÙ‰ Ø±ÙƒØ§Ø¨ Ù…Ù†Ø®ÙØ¶
}

# Ø§Ù„ØªÙ†Ø¨Ø¤
predicted_delay = predict_delay(model, features)
print(f"Ø§Ù„ØªØ£Ø®ÙŠØ± Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: {predicted_delay:.2f} Ø¯Ù‚ÙŠÙ‚Ø©")
```

---

## âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

1. **ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**: ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØµÙÙˆÙ Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù‚ÙŠÙ… ÙØ§Ø±ØºØ© ÙÙŠ Ø§Ù„Ù…ØªØºÙŠØ± Ø§Ù„ØªØ§Ø¨Ø¹
2. **Ù…Ø¹Ø§ÙŠØ±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**: ØªØªÙ… Ù…Ø¹Ø§ÙŠØ±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù‚Ø¨Ù„ Ø§Ù„ØªØ¯Ø±ÙŠØ¨
3. **ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**: 80% Ù„Ù„ØªØ¯Ø±ÙŠØ¨ØŒ 20% Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±

---

## ðŸŽ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©

- [ ] Ø¥Ø¶Ø§ÙØ© Ù†Ù…ÙˆØ°Ø¬ LSTM Ù„Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø³Ù„Ø§Ø³Ù„ Ø²Ù…Ù†ÙŠØ©
- [ ] ØªØ·ÙˆÙŠØ± API Ù„Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙ†Ø¨Ø¤Ø§Øª
- [ ] ØªØµÙ…ÙŠÙ… ÙˆØ§Ø¬Ù‡Ø© ÙˆÙŠØ¨ Ù„Ù„ØªÙ†Ø¨Ø¤
- [ ] Ù…Ø±Ø§Ù‚Ø¨Ø© Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹

---

## ðŸ“§ Ø§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„Ø¯Ø¹Ù…

ÙÙŠ Ø­Ø§Ù„Ø© ÙˆØ¬ÙˆØ¯ Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø£Ùˆ Ù…Ø´Ø§ÙƒÙ„ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„.

---

**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«**: Ø¯ÙŠØ³Ù…Ø¨Ø± 2025
